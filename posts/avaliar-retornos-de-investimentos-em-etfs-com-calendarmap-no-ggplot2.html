<!DOCTYPE html>
<html lang="pt">
<head>
	<meta charset="utf-8">
	<title>Avaliar retornos de investimentos em ETFs com calendarmap no ggplot2 — Wilson Freitas</title>
	<link rel="shortcut icon" href="http://wilsonfreitas.github.io/images/favicon.ico">
	<meta name="description" content="Title: Avaliar retornos de investimentos em ETFs com calendarmap no ggplot2; Date: 2017-03-24; Author: Wilson Freitas">
	<meta name="author" content="Wilson Freitas">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://wilsonfreitas.github.io/theme/html5.js"></script>
		<![endif]-->
	<!-- <link href="http://wilsonfreitas.github.io/theme/css/ipython.css" rel="stylesheet"> -->
	<link href="http://wilsonfreitas.github.io/theme/css/font-awesome.min.css" rel="stylesheet">
	<link href="http://wilsonfreitas.github.io/theme/css/bootstrap.min.css" rel="stylesheet">
	<link href="http://wilsonfreitas.github.io/theme/css/local.css" rel="stylesheet">
	<link href="http://wilsonfreitas.github.io/theme/css/pygments.css" rel="stylesheet">
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
		tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
	});
	</script>
	<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<meta property="twitter:card" content="summary" />
	<meta property="twitter:site" content="@aboutwilson" />
	<meta property="twitter:title" content="Avaliar retornos de investimentos em ETFs com calendarmap no ggplot2"/>
	<meta property="twitter:description" content="Como avaliar retornos de investimentos em ETFs com calendarmaps no ggplot2 e séries obtidas com rbmfbovespa (https://github.com/wilsonfreitas/rbmfbovespa)."/>
	<meta property="twitter:image" content=""/>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4510606-3', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
<div class="container">
	<nav class="navbar navbar-default" style="margin-top:2em;">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="http://wilsonfreitas.github.io/index.html">Wilson Freitas</a>
			</div>
			<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li><a href="http://wilsonfreitas.github.io/index.html"><i class="fa fa-home"></i> Home</a></li>
					<li><a href="http://wilsonfreitas.github.io/archives.html"><i class="fa fa-archive "></i> Arquivo</a></li>
					<li><a href="http://wilsonfreitas.github.io/pages/about.html"><i class="fa fa-user "></i> Sobre</a></li>
					<li><a href="http://wilsonfreitas.github.io/pages/projects.html"><i class="fa fa-code "></i> Projetos</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="http://wilsonfreitas.github.io/categories.html"><i class="fa fa-archive"></i> Categorias</a></li>
					<li><a href="http://wilsonfreitas.github.io/tags.html"><i class="fa fa-tags"></i> Tags</a></li>
					<li><a href="http://wilsonfreitas.github.io/feeds/rss.xml"><i class="fa fa-rss"></i> RSS</a></li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="row">
		<div class="col-md-12">
<div class="article" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="text-center article-header">
		<h1 itemprop="name headline" class="article-title">Avaliar retornos de investimentos em ETFs com calendarmap no ggplot2</h1>
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<h4 itemprop="name">Wilson Freitas</h4>
		</span>
		<time datetime="2017-03-24T00:00:00-03:00" itemprop="datePublished">24/03/2017</time>
	</div>
	<div>
		Categoria:
		<span itemprop="articleSection">
			<a href="http://wilsonfreitas.github.io/category/finance.html" rel="category">finance</a>
		</span>
	</div>
 
	<div>
		Tags:
		<span itemprop="keywords">
			<a href="http://wilsonfreitas.github.io/tag/r.html" rel="tag">R</a>
		</span>
		<span itemprop="keywords">
			<a href="http://wilsonfreitas.github.io/tag/rbmfbovespa.html" rel="tag">rbmfbovespa</a>
		</span>
		<span itemprop="keywords">
			<a href="http://wilsonfreitas.github.io/tag/bmfbovespa.html" rel="tag">BM&FBovespa</a>
		</span>
		<span itemprop="keywords">
			<a href="http://wilsonfreitas.github.io/tag/etf.html" rel="tag">ETF</a>
		</span>
		<span itemprop="keywords">
			<a href="http://wilsonfreitas.github.io/tag/ggplot2.html" rel="tag">ggplot2</a>
		</span>
	</div>
	<div itemprop="articleBody" class="article-body"><p>Avaliar o retorno de investimentos em diversos ativos pode levar a questões que vão além dos resultados individuais de cada ativo em um período de tempo.
Até porque retornos passados não são justificativas para desempenho futuro.
Existem muitas formas de visualização de ativos financeiros e já vimos algumas no post
<a href="http://wilsonfreitas.github.io/posts/indicadores-de-desempenho-de-etfs.html">Indicadores de desempenho de ETFs</a>.
Hoje eu vou explorar o calendarmap que permite visualizar a dinâmica retornos de ativos financeiros ao longo do tempo, mas introduzindo que chamo de efeito calendário, pois os dados são agrupados em semanas e meses e isso permite a identificação de eventuais padrões sazonais.</p>
<p>O calendarmap é na prática um heatmap, só que eu divido as células em meses e dias de semana e a cor da célula é definida pela amplitude e direção do retorno do ativo, que varia em torno de zero e assim permite a criação de uma escala com cores distintas para retornos positivos e negativos.
Dessa maneira, visualizo em um único gráfico o efeito de calendário nos retornos dos ativos e posso fazer isso com diversos ativos ao mesmo tempo.</p>
<p>Vou criar um heatmap utilizando o ggplot2 e transformar os dados de forma que seja simples o agrupamento dos meses e dias de semana.
Novamente, vou trabalhar com dados de ETFs que são obtidos dos arquivos de cotações históricas da BM&amp;FBovespa e eu carrego com facilidade utilizando o <a href="https://github.com/wilsonfreitas/rbmfbovespa">rbmfbovespa</a>.</p>
<p>Além dos pacotes ggplot2 e rbmfbovespa vou carregar também dplyr, tidyr e xts que serão úteis no conjunto de transformações que terei que realizar para ter os dados em um formato adequado para a criação do gráfico.</p>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>rbmfbovespa<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>xts<span class="p">)</span>
</pre></div>


<p>Carregando os dados de ETFs.</p>
<div class="highlight"><pre><span></span>ch_2016 <span class="o">&lt;-</span> read_marketdata<span class="p">(</span><span class="s">&#39;datasets/COTAHIST_A2016.TXT&#39;</span><span class="p">,</span> <span class="s">&#39;COTAHIST&#39;</span><span class="p">)</span>
etfs <span class="o">&lt;-</span> ch_2016<span class="p">[[</span><span class="m">2</span><span class="p">]]</span> <span class="o">%&gt;%</span> filter<span class="p">(</span>especificacao <span class="o">==</span> <span class="s">&#39;CI&#39;</span><span class="p">,</span>
                                tipo_mercado <span class="o">==</span> <span class="m">10</span><span class="p">,</span>
                                stringr<span class="o">::</span>str_detect<span class="p">(</span>nome_empresa<span class="p">,</span> <span class="s">&quot;^(BB ETF|CAIXAETF|ISHARE|IT NOW)&quot;</span><span class="p">))</span>
</pre></div>


<p>Vou fazer uma contagem da quantidade de dias que cada ETF apresentou valor para ter uma ideia da liquidez e utilizar isso para escolher quais ETFs vou colocar no gráfico.</p>
<div class="highlight"><pre><span></span>etfs <span class="o">%&gt;%</span>
  select<span class="p">(</span>cod_negociacao<span class="p">,</span> data_referencia<span class="p">,</span> preco_ult<span class="p">)</span> <span class="o">%&gt;%</span>
  group_by<span class="p">(</span>cod_negociacao<span class="p">)</span> <span class="o">%&gt;%</span>
  summarise<span class="p">(</span>Count <span class="o">=</span> n<span class="p">())</span> <span class="o">%&gt;%</span>
  arrange<span class="p">(</span>desc<span class="p">(</span>Count<span class="p">))</span> <span class="o">%&gt;%</span>
  formattable<span class="o">::</span>formattable<span class="p">()</span>
</pre></div>


<table class="table table-condensed">
 <thead>
  <tr>
   <th style="text-align:right;"> cod_negociacao </th>
   <th style="text-align:right;"> Count </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> BOVA11 </td>
   <td style="text-align:right;"> 249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> DIVO11 </td>
   <td style="text-align:right;"> 249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> IVVB11 </td>
   <td style="text-align:right;"> 249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> PIBB11 </td>
   <td style="text-align:right;"> 249 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> SMAL11 </td>
   <td style="text-align:right;"> 248 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> ISUS11 </td>
   <td style="text-align:right;"> 246 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> SPXI11 </td>
   <td style="text-align:right;"> 245 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> GOVE11 </td>
   <td style="text-align:right;"> 242 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> XBOV11 </td>
   <td style="text-align:right;"> 239 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> BBSD11 </td>
   <td style="text-align:right;"> 238 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> ECOO11 </td>
   <td style="text-align:right;"> 228 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> BRAX11 </td>
   <td style="text-align:right;"> 225 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> FIND11 </td>
   <td style="text-align:right;"> 223 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> MATB11 </td>
   <td style="text-align:right;"> 153 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> BOVV11 </td>
   <td style="text-align:right;"> 64 </td>
  </tr>
</tbody>
</table>

<p>Bem, vou selecionar: DIVO11, GOVE11, BOVA11, PIBB11, SMAL11, ISUS11, IVVB11 e SPXI11.</p>
<div class="highlight"><pre><span></span>etfs <span class="o">%&gt;%</span>
  select<span class="p">(</span>cod_negociacao<span class="p">,</span> data_referencia<span class="p">,</span> preco_ult<span class="p">)</span> <span class="o">%&gt;%</span>
  filter<span class="p">(</span>cod_negociacao <span class="o">%in%</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;DIVO11&#39;</span><span class="p">,</span> <span class="s">&#39;GOVE11&#39;</span><span class="p">,</span> <span class="s">&#39;BOVA11&#39;</span><span class="p">,</span> <span class="s">&#39;PIBB11&#39;</span><span class="p">,</span> <span class="s">&#39;SMAL11&#39;</span><span class="p">,</span> <span class="s">&#39;ISUS11&#39;</span><span class="p">,</span> <span class="s">&#39;IVVB11&#39;</span><span class="p">,</span> <span class="s">&#39;SPXI11&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  arrange<span class="p">(</span>cod_negociacao<span class="p">,</span> data_referencia<span class="p">)</span> <span class="o">-&gt;</span> etfs_data
</pre></div>


<p>A variável <code>etfs_data</code> é um data.frame com três colunas: <code>cod_negociacao</code>, <code>data_referencia</code> e <code>preco_ult</code>. Este data.frame está no formato tidy, onde cada registro da tabela é referente a uma observação.
Note que eu ordeno por <code>cod_negociacao</code> e <code>data_referencia</code>, faço isso para que a tabela seja agrupada por ativos e que os dados dos ativos estejam ordenados pela data.</p>
<p>Agora vou separar cada ETF dessa tabela em séries temporais xts.
Em seguida junto todas as séries xts em um único objeto xts fazendo um <code>merge</code> das séries temporais para que finalmente eu calcule os retornos de todas as séries de uma vez.
Eu faço isso porque através do <code>merge</code> do xts eu preservo o índice entre as séries colocando <code>NA</code> nas datas das séries que não apresentam informação, dado que já levantei anteriormente que algumas séries possuem mais informações do que outras.</p>
<div class="highlight"><pre><span></span>etfs_series <span class="o">&lt;-</span> <span class="kp">lapply</span><span class="p">(</span><span class="kp">split</span><span class="p">(</span>etfs_data<span class="p">,</span> etfs_data<span class="o">$</span>cod_negociacao<span class="p">),</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="p">{</span>
  xts<span class="p">(</span>x<span class="o">$</span>preco_ult<span class="p">,</span> x<span class="o">$</span>data_referencia<span class="p">)</span>
<span class="p">})</span>
etfs_series <span class="o">&lt;-</span> <span class="kp">do.call</span><span class="p">(</span><span class="kp">merge</span><span class="p">,</span> etfs_series<span class="p">)</span>
etfs_series <span class="o">&lt;-</span> PerformanceAnalytics<span class="o">::</span>CalculateReturns<span class="p">(</span>etfs_series<span class="p">,</span> method <span class="o">=</span> <span class="s">&#39;log&#39;</span><span class="p">)</span>
</pre></div>


<p>Após a execução do trecho de código acima eu termino com a variável <code>etfs_series</code> que é um objeto xts com as séries temporais dos retornos das ETFs selecionadas.
Agora eu preciso voltar novamente ao formato tidy para criar o gráfico utilizando o ggplot2.
Dessa maneira, eu terei um data.frame onde cada registro terá <code>cod_negociacao</code>, <code>data_referencia</code> e <code>retorno</code>.
Para fazer isso eu executo as seguintes transformações em <code>etfs_series</code>:</p>
<ol>
<li>Transformo em um data.frame com <code>as.data.frame</code> onde cada coluna é uma ETF</li>
<li>Crio a coluna <code>data_referencia</code> a partir do <code>index</code> de <code>etfs_series</code>, então além das colunas com as ETFs tenho também a nova coluna com a data de referência</li>
<li>Trasnformo o data.frame horizontal em um data.frame vertical onde os nomes das colunas formam a variável <code>cod_negociacao</code> e os valores formam a variável <code>retorno</code>, ou seja, eu utilizo os nomes das colunas como <em>labels</em> para os valores que são os retornos.</li>
<li>Crio quatro novas colunas a partir de <code>data_referencia</code><ul>
<li><code>mes</code> que é um factor com o mês abreviado</li>
<li><code>dia</code> que é um inteiro com o dia do mês</li>
<li><code>dia_semana</code> que é um factor com o dia da semana abreviado</li>
<li><code>semana_mes</code> que é a semana do mês ao qual o dia pertence</li>
</ul>
</li>
</ol>
<p>Precisei criar a função <code>first_day_of_month_wday_adj</code> para definir a semana do mês na qual a data de referência está.
É necessário fazer um ajuste no dia do mês (1 ... {28, 29, 30, 31}) pelo dia da semana (1 ... 7) para que um dia 7 que cai em uma segunda-feira fique na segunda semana e não na primeira.
Este ajuste é feito a partir de um descolcamento sobre os dias do mês de acordo com o dia da semana do primeiro dia do mês.
Se o primeiro dia do mês é um domingo o ajuste é zero, logo não há ajuste, se o primeiro dia da semana é uma segunda-feira, o ajuste é de 1 dia e dessa maneira o dia 7 do mês cai na segunda semana.
A regra segue para os demais dias da semana.</p>
<p>Ao fim chego ao data.frame <code>etfs_returns</code> sete colunas.</p>
<div class="highlight"><pre><span></span>first_day_of_month_wday_adj <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>dx<span class="p">)</span> <span class="p">{</span>
  lubridate<span class="o">::</span>day<span class="p">(</span>dx<span class="p">)</span> <span class="o">&lt;-</span> <span class="m">1</span>
  lubridate<span class="o">::</span>wday<span class="p">(</span>dx<span class="p">)</span> <span class="o">-</span> <span class="m">1</span>
<span class="p">}</span>
etfs_returns <span class="o">&lt;-</span> etfs_series <span class="o">%&gt;%</span>
  <span class="kp">as.data.frame</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="c1"># 1</span>
  mutate<span class="p">(</span>data_referencia <span class="o">=</span> index<span class="p">(</span>etfs_series<span class="p">))</span> <span class="o">%&gt;%</span> <span class="c1"># 2</span>
  gather<span class="p">(</span>cod_negociacao<span class="p">,</span> retorno<span class="p">,</span> <span class="o">-</span> data_referencia<span class="p">)</span> <span class="o">%&gt;%</span> <span class="c1"># 3</span>
  mutate<span class="p">(</span>cod_negociacao <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>cod_negociacao<span class="p">,</span> levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#39;DIVO11&#39;</span><span class="p">,</span> <span class="s">&#39;GOVE11&#39;</span><span class="p">,</span> <span class="s">&#39;BOVA11&#39;</span><span class="p">,</span> <span class="s">&#39;PIBB11&#39;</span><span class="p">,</span> <span class="s">&#39;ISUS11&#39;</span><span class="p">,</span> <span class="s">&#39;SMAL11&#39;</span><span class="p">,</span> <span class="s">&#39;IVVB11&#39;</span><span class="p">,</span> <span class="s">&#39;SPXI11&#39;</span><span class="p">)))</span> <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>mes <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>lubridate<span class="o">::</span>month<span class="p">(</span>data_referencia<span class="p">),</span> labels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;jan&quot;</span><span class="p">,</span> <span class="s">&quot;fev&quot;</span><span class="p">,</span> <span class="s">&quot;mar&quot;</span><span class="p">,</span> <span class="s">&quot;abr&quot;</span><span class="p">,</span> <span class="s">&quot;mai&quot;</span><span class="p">,</span> <span class="s">&quot;jun&quot;</span><span class="p">,</span> <span class="s">&quot;jul&quot;</span><span class="p">,</span> <span class="s">&quot;ago&quot;</span><span class="p">,</span> <span class="s">&quot;set&quot;</span><span class="p">,</span> <span class="s">&quot;out&quot;</span><span class="p">,</span> <span class="s">&quot;nov&quot;</span><span class="p">,</span> <span class="s">&quot;dez&quot;</span><span class="p">)),</span>
         dia <span class="o">=</span> lubridate<span class="o">::</span>day<span class="p">(</span>data_referencia<span class="p">),</span>
         dia_semana <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>lubridate<span class="o">::</span>wday<span class="p">(</span>data_referencia<span class="p">),</span> labels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;seg&quot;</span><span class="p">,</span> <span class="s">&quot;ter&quot;</span><span class="p">,</span> <span class="s">&quot;qua&quot;</span><span class="p">,</span> <span class="s">&quot;qui&quot;</span><span class="p">,</span> <span class="s">&quot;sex&quot;</span><span class="p">)),</span>
         semana_mes <span class="o">=</span> <span class="kp">ceiling</span><span class="p">((</span>lubridate<span class="o">::</span>day<span class="p">(</span>data_referencia<span class="p">)</span> <span class="o">+</span> first_day_of_month_wday_adj<span class="p">(</span>data_referencia<span class="p">))</span> <span class="o">/</span> <span class="m">7</span><span class="p">))</span> <span class="c1"># 4</span>
</pre></div>


<p>Agora vou chamar o ggplot2 para construir o calendarmap.</p>
<div class="highlight"><pre><span></span>ggplot<span class="p">(</span>etfs_returns<span class="p">,</span> aes<span class="p">(</span>y <span class="o">=</span> dia_semana<span class="p">,</span> x <span class="o">=</span> semana_mes<span class="p">,</span> fill <span class="o">=</span> retorno<span class="p">))</span> <span class="o">+</span>
  geom_tile<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;grey50&quot;</span><span class="p">)</span> <span class="o">+</span>
  facet_grid<span class="p">(</span>cod_negociacao <span class="o">~</span> mes<span class="p">)</span> <span class="o">+</span>
  scale_fill_gradient2<span class="p">(</span>low <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> high <span class="o">=</span> <span class="s">&quot;darkgreen&quot;</span><span class="p">,</span> midpoint <span class="o">=</span> <span class="m">0</span><span class="p">,</span> na.value <span class="o">=</span> <span class="s">&quot;grey50&quot;</span><span class="p">)</span> <span class="o">+</span>
  theme<span class="p">(</span>axis.text <span class="o">=</span> element_text<span class="p">(</span>size <span class="o">=</span> <span class="m">10</span><span class="p">),</span>
        axis.title <span class="o">=</span> element_blank<span class="p">(),</span>
        axis.text.x <span class="o">=</span> element_blank<span class="p">(),</span>
        axis.ticks.x <span class="o">=</span> element_blank<span class="p">(),</span>
        axis.ticks.y <span class="o">=</span> element_blank<span class="p">(),</span>
        strip.text <span class="o">=</span> element_text<span class="p">(</span>size <span class="o">=</span> <span class="m">10</span><span class="p">),</span>
        legend.position <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">,</span>
        panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span>
        panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
        panel.background <span class="o">=</span> element_blank<span class="p">())</span>
</pre></div>


<p><img alt="plot of chunk lamina_com_desempenho_de_etfs-6" src="http://wilsonfreitas.github.io/figure/lamina_com_desempenho_de_etfs-6-1.png"></p>
<p>Bem, pessoalmente fiquei emocionado após concluir o gráfico acima, realmente, achei bom mesmo.
É possível observar a dinâmica dos ativos ao longo do ano e é bem diferente de um gráfico de
retornos (como no post <a href="http://wilsonfreitas.github.io/posts/indicadores-de-desempenho-de-etfs.html">Indicadores de desempenho de ETFs</a>) 
onde a dinâmica dentro do calendário não fica evidente.
Esse é um gráfico legal para se apresentar resultados de fundos de investimento, por exemplo.</p></div>
	<hr>
	<h2>Comments</h2>
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'aboutwilson'; 
    var disqus_title = 'Avaliar retornos de investimentos em ETFs com calendarmap no ggplot2';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
		</div>
	</div>
</div>
<div class="container">
	<div class="row">
		<div class="col-md-12 text-center center-block aw-bottom">
			<p>&copy; Wilson Freitas 2015</p>
			<p>Powered by Pelican</p>
		</div>
	</div>
</div>
<!-- JavaScript -->
<script src="http://wilsonfreitas.github.io/theme/js/jquery-2.1.1.min.js"></script>
<script src="http://wilsonfreitas.github.io/theme/js/bootstrap.min.js"></script>
<script type="text/javascript">
$(document).ready(function($) {
	$("div.collapseheader").click(function () {
		$header = $(this).children("span").first();
		$codearea = $(this).children(".input_area");
		$codearea.slideToggle(500, function () {
			$header.text(function () {
				return $codearea.is(":visible") ? "Collapse Code" : "Expand Code";
			});
		});
	});
});
</script>
 
</body>
</html>